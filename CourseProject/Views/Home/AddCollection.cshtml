@model CourseProject.Models.Collection
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>Add Collectino</title>
    <link href="@Url.Content("~/Content/site.css")" rel="stylesheet" type="text/css" />
    <script src="~/Scripts/dropzone/dropzone.min.js"></script>
    <script src="~/Scripts/jquery-3.4.1.js"></script>
    <link href="~/Scripts/dropzone/dropzone.css" rel="stylesheet" />
</head>
<body>
    <h4>Add new collection</h4>
    @using (Html.BeginForm())
    {
        <div>
            Title:
            @Html.TextBoxFor(model => model.Title, new { @id = "text" });
        </div>
        <div>
            Desciption:
            @Html.TextBoxFor(model => model.Description, new { @id = "text" });
        </div>
        <div>
            Items Count:
            @Html.TextBoxFor(model => model.ItemsCount, new { @id = "text" });
        </div>
        <div>
            Theme:
            @Html.DropDownList("Theme", selectList: (IEnumerable<SelectListItem>)new SelectList(ViewBag.Themes))
        </div>
        <div class="dropzone" id="my-dropzone" method="post"></div>
        @Html.HiddenFor(model => model.Image, new { id = "img" })
        @Html.HiddenFor(model => model.UserId, new { id = "userId", Value = ViewBag.UserId })
        <div>
            <button type="button" id="submit-all"> Upload </button>
        </div>

        <div>
            <button type="submit" id="submit-all"> Create </button>
        </div>
    }
</body>
</html>



<script>
        Dropzone.options.myDropzone = {
            url: "@Url.Action("Upload", "Home")",
            maxFiles: 1,
            addRemoveLinks: true,
            autoProcessQueue: false,
            uploadMultiple: false,
            parallelUploads: 1,

            init: function () {
                var submitButton = document.querySelector("#submit-all")
                myDropzone = this;

                submitButton.addEventListener("click", function () {
                    myDropzone.processQueue();
                });
                this.on("complete", function (data) {
                    var res = eval('(' + data.xhr.responseText + ')');
                    $('#img').val(res.Message);
                });
            }
        };
</script>